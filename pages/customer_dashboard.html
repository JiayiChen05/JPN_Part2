<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Public Affirmation Library</title>
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/theme-toggle.css" />
    <link rel="stylesheet" href="../css/books.css" />
    <link rel="stylesheet" href="../css/events.css" />
    <link rel="stylesheet" href="../css/user-dropdown.css" />
    <link rel="stylesheet" href="../css/dashboard-rooms.css" />
    <link rel="stylesheet" href="../css/dashboard-books.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
      rel="stylesheet"
    />
    <style>
      .scroll-container {
        width: 100%;
        padding: 1rem 0;
        position: relative;
      }
      
      .scroll-content {
        display: flex;
        gap: 2rem;
        padding: 0 2rem;
        justify-content: center;
        position: relative;
      }
      
      .section-heading {
        font-size: 2rem;
        margin: 3rem 0 1rem 2rem;
        font-weight: 400;
        color: var(--text-primary);
      }
      
      .book-card,
      .event-card {
        min-width: 300px;
        max-width: 300px;
        background: var(--card-bg);
        border-radius: 12px;
        overflow: hidden;
        border: 1px solid var(--border-color);
        transition: all 0.3s ease;
        position: relative;
        box-shadow: 0 4px 8px var(--shadow-color);
      }
      
      .book-card:hover,
      .event-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px var(--shadow-color);
        border-color: var(--accent-primary);
      }
      
      .book-info,
      .event-content {
        padding: 1.5rem;
      }
      
      .book-info h3,
      .event-content h3 {
        color: var(--text-primary);
        font-size: 1.25rem;
        font-weight: 500;
        margin-bottom: 1rem;
      }
      
      .book-details,
      .event-details {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
      }
      
      .detail {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-secondary);
        font-size: 0.9rem;
      }
      
      .detail svg {
        width: 16px;
        height: 16px;
        color: var(--accent-primary);
      }
      
      .nav-buttons {
        display: flex;
        align-items: center;
        gap: 1rem;
      }
      
      @media (max-width: 768px) {
        .nav-buttons {
          flex-wrap: wrap;
          justify-content: flex-end;
        }
      }
      
      .container-with-arrows {
        position: relative;
        max-width: 1320px;
        margin: 0 auto;
        padding: 0 100px; /* Increased padding to make room for arrows */
      }
      
      .pagination-arrow {
        background: var(--accent-primary);
        color: white;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s;
        position: absolute;
        z-index: 10;
      }
      
      .pagination-arrow:hover {
        background: var(--accent-secondary);
      }
      
      .pagination-arrow svg {
        width: 24px;
        height: 24px;
      }
      
      .pagination-arrow:disabled {
        background: #ccc;
        cursor: not-allowed;
      }
      
      .pagination-arrow.prev {
        left: -50px; /* Position left arrow outside the content */
      }
      
      .pagination-arrow.next {
        right: -50px; /* Position right arrow outside the content */
      }
      
      .action-btn {
        display: block;
        max-width: 200px;
        margin: 2rem auto;
        text-align: center;
      }
      
      /* Ensure proper spacing for event tiles */
      #eventsContainer, #booksContainer {
        padding: 0 20px;
        width: 100%;
        box-sizing: border-box;
      }
      
      /* Table cell padding */
      td,
      th {
        padding: 10px 15px;
      }
      
      /* Contact styles */
      .contact-container {
        max-width: 800px;
        margin: 3rem auto;
        padding: 0 1rem;
        font-size: 1.1rem;
        line-height: 1.6;
      }

      .contact-item {
        display: flex;
        align-items: center;
        margin-bottom: 1.2rem;
      }

      .contact-item svg {
        width: 20px;
        height: 20px;
        margin-right: 0.6rem;
        flex-shrink: 0;
        color: var(--accent-primary);
      }

      .contact-item a {
        color: var(--accent-primary);
        text-decoration: none;
      }

      .contact-item a:hover {
        text-decoration: underline;
      }
      
      /* Active navigation button */
      .nav-buttons a.active {
        border-bottom: 2px solid var(--accent-primary);
        color: var(--accent-primary);
        font-weight: 500;
      }
      
      /* Sponsor styles */
      .sponsor-container {
        max-width: 700px;
        margin: 0 auto;
        padding: 4rem 2rem;
      }

      .sponsor-container h2 {
        font-size: 2.5rem;
        color: var(--text-primary);
        margin-bottom: 2rem;
        font-weight: 300;
        letter-spacing: -0.5px;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-group label {
        display: block;
        margin-bottom: 0.75rem;
        color: var(--text-primary);
        font-weight: 500;
      }

      .form-group select,
      .form-group input {
        width: 100%;
        padding: 0.75rem 1rem;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        background-color: var(--input-bg);
        color: var(--text-primary);
        font-size: 1rem;
        transition: all 0.3s;
      }

      .form-group select:focus,
      .form-group input:focus {
        border-color: var(--accent-primary);
        outline: none;
        box-shadow: 0 0 0 2px var(--shadow-color);
      }

      .btn-submit {
        padding: 0.75rem 1.5rem;
        background-color: var(--accent-primary);
        color: white;
        border: none;
        border-radius: 25px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.3s;
        font-size: 1rem;
        margin-top: 1rem;
        width: 100%;
      }

      .btn-submit:hover {
        background-color: var(--accent-secondary);
        transform: translateY(-2px);
      }

      #resultMessage {
        margin-top: 1.5rem;
        padding: 1rem;
        border-radius: 8px;
        background-color: var(--bg-secondary);
        color: var(--text-primary);
        text-align: center;
        display: none;
      }

      #resultMessage.show {
        display: block;
        animation: fadeIn 0.5s;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <nav class="navbar">
        <div class="logo">
          <h1>Public Affirmation Library</h1>
        </div>
        <div class="nav-buttons">
          <a href="#" class="btn active" id="home-btn">Home</a>
          <a href="#" class="btn" id="contact-btn">Contact</a>
          <a href="#" class="btn" id="sponsor-btn">Sponsor</a>
          <a href="#" class="btn" id="books-btn">Books</a>
          <a href="#" class="btn" id="rooms-btn">Rooms</a>
          <a href="#" class="btn" id="events-btn">Events</a>
          <div class="dropdown">
            <a href="#" class="btn dropdown-toggle" id="username-btn">Loading...</a>
            <div class="dropdown-content">
              <a href="#" class="sign-out">Sign Out</a>
            </div>
          </div>
          <button
            class="theme-toggle"
            onclick="toggleTheme()"
            aria-label="Toggle theme"
          >
            <svg
              class="sun-icon"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
            >
              <path
                d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM12 21.75a.75.75 0 01-.75-.75v-2.25a.75.75 0 011.5 0V21a.75.75 0 01-.75.75zM3 12a.75.75 0 01.75-.75h2.25a.75.75 0 010 1.5H3.75A.75.75 0 013 12zM21 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5h2.25A.75.75 0 0121 12zM5.78 5.78a.75.75 0 011.06 0l1.5 1.5a.75.75 0 01-1.06 1.06l-1.5-1.5a.75.75 0 010-1.06zM18.22 18.22a.75.75 0 01-1.06 0l-1.5-1.5a.75.75 0 011.06-1.06l1.5 1.5a.75.75 0 010 1.06zM18.22 5.78a.75.75 0 010 1.06l-1.5 1.5a.75.75 0 11-1.06-1.06l1.5-1.5a.75.75 0 011.06 0zM5.78 18.22a.75.75 0 010-1.06l1.5-1.5a.75.75 0 111.06 1.06l-1.5 1.5a.75.75 0 01-1.06 0z"
              />
            </svg>
            <svg
              class="moon-icon"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
            >
              <path
                d="M9.528 1.718a.75.75 0 01.162.819A8.97 8.97 0 009 6a9 9 0 009 9 8.97 8.97 0 003.463-.69.75.75 0 01.981.98 10.503 10.503 0 01-9.694 6.46c-5.799 0-10.5-4.701-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 01.818.162z"
              />
            </svg>
          </button>
        </div>
      </nav>
    </header>

    <main>
      <div id="content-container">
        <div id="home-content">
          <div class="hero-section">
            <h2>Welcome to Your Library</h2>
            <p>Discover, Learn, and Grow with Us</p>
          </div>

          <h2 class="section-heading">Books</h2>
          <div class="container-with-arrows">
            <button id="prevBooks" class="pagination-arrow prev" disabled>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
              </svg>
            </button>
            <div class="scroll-content" id="booksContainer">
              <!-- Books will be loaded here using JavaScript -->
            </div>
            <button id="nextBooks" class="pagination-arrow next">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </button>
            <a href="#" onclick="document.getElementById('books-btn').click(); return false;" class="btn action-btn">Rent a Book</a>
          </div>

          <h2 class="section-heading">Events</h2>
          <div class="container-with-arrows">
            <button id="prevEvents" class="pagination-arrow prev" disabled>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
              </svg>
            </button>
            <div class="scroll-content" id="eventsContainer">
              <!-- Events will be loaded here using JavaScript -->
            </div>
            <button id="nextEvents" class="pagination-arrow next">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </button>
            <a href="#" onclick="document.getElementById('events-btn').click(); return false;" class="btn action-btn">Register for an Event</a>
          </div>
        </div>
        
        <div id="contact-content" style="display: none;">
          <div class="contact-container">
            <h2>Contact Us</h2>
            <p>We're here to help! Reach out to us through any of the following methods:</p>

            <div class="contact-item">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
              </svg>
              <span>Email: <a href="mailto:info@affirmationlibrary.org">info@affirmationlibrary.org</a></span>
            </div>

            <div class="contact-item">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372a1.125 1.125 0 00-.852-1.09l-4.423-1.106a1.125 1.125 0 00-1.173.417l-.97 1.293a1.125 1.125 0 01-1.21.38 12.035 12.035 0 01-7.143-7.143 1.125 1.125 0 01.38-1.21l1.293-.97a1.125 1.125 0 00.417-1.173L6.963 3.102A1.125 1.125 0 005.872 2.25H4.5A2.25 2.25 0 002.25 4.5v2.25z" />
              </svg>
              <span>Phone: (123) 456-7890</span>
            </div>

            <div class="contact-item">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
              </svg>
              <span>Address: 123 Library Lane, Booktown, NY 10001</span>
            </div>
          </div>
        </div>
        
        <div id="sponsor-content" style="display: none;">
          <div class="sponsor-container">
            <h2>
              <svg
                width="32"
                height="32"
                viewBox="0 0 24 24"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"
                  stroke="currentColor"
                  stroke-width="1.5"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              Sponsor a Seminar
            </h2>

            <form id="sponsorForm" onsubmit="handleSponsor(event)">
              <div class="form-group">
                <label for="seminarSelect">Select Seminar *</label>
                <select id="seminarSelect" required>
                  <option value="">Loading seminars...</option>
                </select>
              </div>

              <div class="form-group">
                <label for="sponsorType">Sponsor Type *</label>
                <select id="sponsorType" required onchange="toggleSponsorFields()">
                  <option value="">-- Select Type --</option>
                  <option value="individual">Individual</option>
                  <option value="organization">Organization</option>
                </select>
              </div>

              <div id="individualFields">
                <div class="form-group">
                  <label for="fname">First Name *</label>
                  <input type="text" id="fname" required />
                </div>

                <div class="form-group">
                  <label for="lname">Last Name *</label>
                  <input type="text" id="lname" required />
                </div>
              </div>

              <div id="organizationFields" style="display: none;">
                <div class="form-group">
                  <label for="orgName">Organization Name *</label>
                  <input type="text" id="orgName" />
                </div>
              </div>

              <div class="form-group">
                <label for="amount">Sponsorship Amount ($) *</label>
                <input type="number" id="amount" required min="1" step="0.01" />
              </div>

              <button type="submit" class="btn-submit">Submit Sponsorship</button>
            </form>

            <div id="resultMessage"></div>
          </div>
        </div>
        
        <div id="books-content" style="display: none;">
          <div class="book-container">
            <div class="book-tabs">
              <button class="book-tab-button active" data-tab="available-books" onclick="switchBookTab('available-books')">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" 
                    stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                Available Books
              </button>
              <button class="book-tab-button" data-tab="my-rentals" onclick="switchBookTab('my-rentals')">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M16.5 3.75V16.5L12 14.25 7.5 16.5V3.75m9 0H18A2.25 2.25 0 0120.25 6v12A2.25 2.25 0 0118 20.25H6A2.25 2.25 0 013.75 18V6A2.25 2.25 0 016 3.75h1.5m9 0h-9" 
                    stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                My Rentals
              </button>
            </div>
            
            <div id="available-books" class="book-tab-content">
              <div id="book-filters" class="book-filters">
                <div class="filter-group">
                  <label for="book-category">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z" 
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                      <path d="M6 6h.01" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Category
                  </label>
                  <select id="book-category">
                    <option value="">All Categories</option>
                    <!-- Categories will be loaded by JavaScript -->
                  </select>
                </div>
                <div class="filter-group">
                  <label for="book-search">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" 
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Search
                  </label>
                  <input type="text" id="book-search" placeholder="Search by title or author..." />
                </div>
              </div>
              
              <div id="books-grid" class="books-grid">
                <!-- Book cards will be loaded here by JavaScript -->
                <div class="loading-indicator">
                  <p>Loading books...</p>
                </div>
              </div>
            </div>
            
            <div id="my-rentals" class="book-tab-content" style="display: none;">
              <div id="my-rentals-content">
                <!-- Rentals will be loaded here by JavaScript -->
                <div class="loading-indicator">
                  <p>Loading your rentals...</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div id="rooms-content" style="display: none;">
          <div class="room-container">
            <div class="room-tabs">
              <button class="room-tab-button active" data-tab="available-rooms" onclick="switchRoomTab('available-rooms')">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" 
                    stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                Available Rooms
              </button>
              <button class="room-tab-button" data-tab="my-reservations" onclick="switchRoomTab('my-reservations')">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" 
                    stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                My Reservations
              </button>
            </div>
            
            <div id="available-rooms" class="room-tab-content">
              <div id="room-filters" class="room-filters">
                <div class="filter-group">
                  <label for="capacity">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" 
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Capacity
                  </label>
                  <select id="capacity">
                    <option value="">Any Capacity</option>
                    <option value="5">&lt;5 People</option>
                    <option value="10">&lt;10 People</option>
                    <option value="15">&lt;15 People</option>
                    <option value="20">&lt;20 People</option>
                  </select>
                </div>
                <div class="filter-group">
                  <label for="date">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" 
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Date
                  </label>
                  <input type="date" id="date" min="" />
                </div>
                <div class="filter-group">
                  <label for="time">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" 
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Time
                  </label>
                  <input type="time" id="time" />
                </div>
                <div class="filter-group">
                  <label for="search">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" 
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Search
                  </label>
                  <input type="text" id="search" placeholder="Search by room number..." />
                </div>
              </div>
              
              <div id="rooms-grid" class="rooms-grid">
                <!-- Room cards will be loaded here by JavaScript -->
                <div class="loading-indicator">
                  <p>Loading rooms...</p>
                </div>
              </div>
            </div>
            
            <div id="my-reservations" class="room-tab-content" style="display: none;">
              <div id="my-reservations-content">
                <!-- Reservations will be loaded here by JavaScript -->
                <div class="loading-indicator">
                  <p>Loading your reservations...</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <p>&copy; 2024 Public Affirmation Library. All rights reserved.</p>
    </footer>

    <script src="../js/theme-toggle.js"></script>
    <script src="../js/user-auth.js"></script>
    <script src="../js/dashboard-rooms.js"></script>
    <script src="../js/dashboard-books.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // Handle Contact button
        const contactBtn = document.getElementById('contact-btn');
        const homeBtn = document.getElementById('home-btn');
        const sponsorBtn = document.getElementById('sponsor-btn');
        const roomsBtn = document.getElementById('rooms-btn');
        const booksBtn = document.getElementById('books-btn');
        const eventsBtn = document.getElementById('events-btn');
        const homeContent = document.getElementById('home-content');
        const contactContent = document.getElementById('contact-content');
        const sponsorContent = document.getElementById('sponsor-content');
        const roomsContent = document.getElementById('rooms-content');
        const booksContent = document.getElementById('books-content');
        
        contactBtn.addEventListener('click', function(e) {
          e.preventDefault();
          homeContent.style.display = 'none';
          contactContent.style.display = 'block';
          sponsorContent.style.display = 'none';
          roomsContent.style.display = 'none';
          booksContent.style.display = 'none';
          
          // Hide events content if it exists
          const eventsContent = document.getElementById('events-content');
          if (eventsContent) {
            eventsContent.style.display = 'none';
          }
          
          // Update active state in navigation
          document.querySelectorAll('.nav-buttons a').forEach(link => {
            link.classList.remove('active');
          });
          contactBtn.classList.add('active');
        });
        
        // Handle Home button
        homeBtn.addEventListener('click', function(e) {
          e.preventDefault();
          showHomeContent();
        });
        
        // Handle Sponsor button
        sponsorBtn.addEventListener('click', function(e) {
          e.preventDefault();
          homeContent.style.display = 'none';
          contactContent.style.display = 'none';
          sponsorContent.style.display = 'block';
          roomsContent.style.display = 'none';
          booksContent.style.display = 'none';
          
          // Hide events content if it exists
          const eventsContent = document.getElementById('events-content');
          if (eventsContent) {
            eventsContent.style.display = 'none';
          }
          
          // Update active state in navigation
          document.querySelectorAll('.nav-buttons a').forEach(link => {
            link.classList.remove('active');
          });
          sponsorBtn.classList.add('active');
          
          // Load seminars if needed
          if (!window.seminarsLoaded) {
            loadSeminars();
            window.seminarsLoaded = true;
          }
        });
        
        // Handle Rooms button
        roomsBtn.addEventListener('click', function(e) {
          e.preventDefault();
          homeContent.style.display = 'none';
          contactContent.style.display = 'none';
          sponsorContent.style.display = 'none';
          roomsContent.style.display = 'block';
          booksContent.style.display = 'none';
          
          // Hide events content if it exists
          const eventsContent = document.getElementById('events-content');
          if (eventsContent) {
            eventsContent.style.display = 'none';
          }
          
          // Update active state in navigation
          document.querySelectorAll('.nav-buttons a').forEach(link => {
            link.classList.remove('active');
          });
          roomsBtn.classList.add('active');
          
          // Initialize rooms functionality when tab is clicked
          initializeRooms();
        });
        
        // Handle Books button
        booksBtn.addEventListener('click', function(e) {
          e.preventDefault();
          homeContent.style.display = 'none';
          contactContent.style.display = 'none';
          sponsorContent.style.display = 'none';
          roomsContent.style.display = 'none';
          booksContent.style.display = 'block';
          
          // Hide events content if it exists
          const eventsContent = document.getElementById('events-content');
          if (eventsContent) {
            eventsContent.style.display = 'none';
          }
          
          // Update active state in navigation
          document.querySelectorAll('.nav-buttons a').forEach(link => {
            link.classList.remove('active');
          });
          booksBtn.classList.add('active');
          
          // Initialize books functionality when tab is clicked
          initializeBooks();
        });
        
        // Handle Events button
        eventsBtn.addEventListener('click', function(e) {
          e.preventDefault();
          homeContent.style.display = 'none';
          contactContent.style.display = 'none';
          sponsorContent.style.display = 'none';
          roomsContent.style.display = 'none';
          booksContent.style.display = 'none';
          
          // Update active state in navigation
          document.querySelectorAll('.nav-buttons a').forEach(link => {
            link.classList.remove('active');
          });
          eventsBtn.classList.add('active');
          
          // Load the events content
          loadEvents();
        });
        
        // Function to show home content
        function showHomeContent() {
          homeContent.style.display = 'block';
          contactContent.style.display = 'none';
          sponsorContent.style.display = 'none';
          roomsContent.style.display = 'none';
          booksContent.style.display = 'none';
          
          // Hide events content if it exists
          const eventsContent = document.getElementById('events-content');
          if (eventsContent) {
            eventsContent.style.display = 'none';
          }
          
          // Update active state in navigation
          document.querySelectorAll('.nav-buttons a').forEach(link => {
            link.classList.remove('active');
          });
          homeBtn.classList.add('active');
        }
        
        // Add click handler for logo to return to home
        document.querySelector('.logo').addEventListener('click', function() {
          showHomeContent();
        });
        
        const booksContainer = document.getElementById('booksContainer');
        const eventsContainer = document.getElementById('eventsContainer');
        const prevEventsBtn = document.getElementById('prevEvents');
        const nextEventsBtn = document.getElementById('nextEvents');
        const prevBooksBtn = document.getElementById('prevBooks');
        const nextBooksBtn = document.getElementById('nextBooks');
        
        // Fix the base URL to include the correct path
        const baseUrl = '../api';
        
        let allEvents = [];
        let allBooks = [];
        let currentEventPage = 0;
        let currentBookPage = 0;
        const eventsPerPage = 4;
        const booksPerPage = 4;

        // Function to position arrows at the center of tiles
        function positionArrows() {
          // For books
          if (booksContainer.children.length > 0) {
            const bookTile = booksContainer.children[0];
            const bookTileHeight = bookTile.offsetHeight;
            const bookTileTop = bookTile.offsetTop;
            const arrowTop = bookTileTop + (bookTileHeight / 2) - 20; // 20 is half the arrow height
            
            prevBooksBtn.style.top = `${arrowTop}px`;
            nextBooksBtn.style.top = `${arrowTop}px`;
          }
          
          // For events
          if (eventsContainer.children.length > 0) {
            const eventTile = eventsContainer.children[0];
            const eventTileHeight = eventTile.offsetHeight;
            const eventTileTop = eventTile.offsetTop;
            const arrowTop = eventTileTop + (eventTileHeight / 2) - 20; // 20 is half the arrow height
            
            prevEventsBtn.style.top = `${arrowTop}px`;
            nextEventsBtn.style.top = `${arrowTop}px`;
          }
        }

        // Fetch books
        async function fetchBooks() {
          try {
            const response = await fetch(`${baseUrl}/get_books.php`);
            if (!response.ok) throw new Error(`HTTP error: ${response.status}`);
            
            const text = await response.text();
            let data;
            try {
              data = JSON.parse(text);
            } catch (e) {
              console.error('Invalid JSON from get_books.php:', text);
              throw e;
            }

            if (data.status === 'success') {
              allBooks = data.books || [];
              displayBookPage(0);
              updateBookPaginationButtons();
              // Position arrows after books are rendered
              setTimeout(positionArrows, 100);
            } else {
              booksContainer.innerHTML = `<div class="error-message">Error: ${data.message}</div>`;
            }
          } catch (error) {
            console.error('Error fetching books:', error);
            booksContainer.innerHTML = `<div class="error-message">Error loading books. Please try again later.</div>`;
          }
        }

        function displayBookPage(page) {
          booksContainer.innerHTML = '';

          if (!allBooks.length) {
            booksContainer.innerHTML = '<div class="no-books">No books found</div>';
            return;
          }

          const startIndex = page * booksPerPage;
          const endIndex = Math.min(startIndex + booksPerPage, allBooks.length);
          const booksToShow = allBooks.slice(startIndex, endIndex);

          booksToShow.forEach(book => {
            const bookCard = document.createElement('div');
            bookCard.className = 'book-card';

            bookCard.innerHTML = `
              <div class="book-info">
                <h3>${book.BOOK_NAME}</h3>
                <div class="book-details">
                  <div class="detail">
                    <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                    <span>Author: ${book.AUTHOR_NAME || 'Unknown'}</span>
                  </div>
                  <div class="detail">
                    <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
                    </svg>
                    <span>Topic: ${book.TOPIC_NAME}</span>
                  </div>
                </div>
              </div>
            `;

            booksContainer.appendChild(bookCard);
          });
          
          currentBookPage = page;
          updateBookPaginationButtons();
          // Position arrows after books are rendered
          setTimeout(positionArrows, 100);
        }
        
        function updateBookPaginationButtons() {
          const maxPage = Math.ceil(allBooks.length / booksPerPage) - 1;
          
          prevBooksBtn.disabled = currentBookPage <= 0;
          nextBooksBtn.disabled = currentBookPage >= maxPage;
        }
        
        // Book pagination event listeners
        prevBooksBtn.addEventListener('click', () => {
          if (currentBookPage > 0) {
            displayBookPage(currentBookPage - 1);
          }
        });
        
        nextBooksBtn.addEventListener('click', () => {
          const maxPage = Math.ceil(allBooks.length / booksPerPage) - 1;
          if (currentBookPage < maxPage) {
            displayBookPage(currentBookPage + 1);
          }
        });

        // Fetch events
        async function fetchEvents() {
          try {
            const response = await fetch(`${baseUrl}/get_events.php`);
            if (!response.ok) throw new Error(`HTTP error: ${response.status}`);

            const data = await response.json();
            if (data.status === 'success') {
              allEvents = data.data;
              displayEventPage(0);
              updateEventPaginationButtons();
              // Position arrows after events are rendered
              setTimeout(positionArrows, 100);
            } else {
              eventsContainer.innerHTML = `<p class="error">Failed to load events: ${data.message}</p>`;
            }
          } catch (error) {
            console.error('Error loading events:', error);
            eventsContainer.innerHTML = `<p class="error">Error loading events.</p>`;
          }
        }

        function displayEventPage(page) {
          eventsContainer.innerHTML = '';
          
          if (!allEvents.length) {
            eventsContainer.innerHTML = '<p class="no-events-message">No events found.</p>';
            return;
          }
          
          const startIndex = page * eventsPerPage;
          const endIndex = Math.min(startIndex + eventsPerPage, allEvents.length);
          const eventsToShow = allEvents.slice(startIndex, endIndex);
          
          eventsToShow.forEach(event => {
            const card = document.createElement('div');
            card.className = 'event-card';
            card.innerHTML = `
              <div class="event-content">
                <h3>${event.E_NAME}</h3>
                <div class="event-details">
                  <div class="detail">
                    <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
                    </svg>
                    <span>Type: ${event.E_TYPE === 'S' ? 'Seminar' : 'Exhibition'}</span>
                  </div>
                  <div class="detail">
                    <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
                    </svg>
                    <span>Topic: ${event.TOPIC_NAME}</span>
                  </div>
                  <div class="detail">
                    <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    <span>Start: ${new Date(event.E_STARTTIME).toLocaleString()}</span>
                  </div>
                </div>
              </div>
            `;
            eventsContainer.appendChild(card);
          });
          
          currentEventPage = page;
          updateEventPaginationButtons();
          // Position arrows after events are rendered
          setTimeout(positionArrows, 100);
        }
        
        function updateEventPaginationButtons() {
          const maxPage = Math.ceil(allEvents.length / eventsPerPage) - 1;
          
          prevEventsBtn.disabled = currentEventPage <= 0;
          nextEventsBtn.disabled = currentEventPage >= maxPage;
        }
        
        // Event pagination listeners
        prevEventsBtn.addEventListener('click', () => {
          if (currentEventPage > 0) {
            displayEventPage(currentEventPage - 1);
          }
        });
        
        nextEventsBtn.addEventListener('click', () => {
          const maxPage = Math.ceil(allEvents.length / eventsPerPage) - 1;
          if (currentEventPage < maxPage) {
            displayEventPage(currentEventPage + 1);
          }
        });

        // Add window resize event to reposition arrows when window size changes
        window.addEventListener('resize', positionArrows);

        fetchBooks();
        fetchEvents();
      });
      
      // Sponsor functionality
      function loadSeminars() {
        fetch("../api/get_seminars.php")
          .then((res) => res.json())
          .then((data) => {
            const select = document.getElementById("seminarSelect");
            select.innerHTML = '<option value="">-- Select Seminar --</option>';

            if (data.status === "success" && data.data.length > 0) {
              // Store seminar data globally to access names later
              window.seminarData = data.data;
              
              data.data.forEach((seminar) => {
                const opt = document.createElement("option");
                opt.value = seminar.E_ID;
                opt.textContent = seminar.E_NAME;
                select.appendChild(opt);
              });
            } else {
              select.innerHTML =
                '<option value="">No seminars available</option>';
            }
          })
          .catch((err) => {
            console.error(err);
            document.getElementById("seminarSelect").innerHTML =
              '<option value="">Error loading</option>';
          });
      }

      function toggleSponsorFields() {
        const sponsorType = document.getElementById("sponsorType").value;
        const individualFields = document.getElementById("individualFields");
        const organizationFields = document.getElementById("organizationFields");
        const fnameInput = document.getElementById("fname");
        const lnameInput = document.getElementById("lname");
        const orgNameInput = document.getElementById("orgName");

        if (sponsorType === "individual") {
          individualFields.style.display = "block";
          organizationFields.style.display = "none";
          fnameInput.setAttribute("required", "");
          lnameInput.setAttribute("required", "");
          orgNameInput.removeAttribute("required");
        } else if (sponsorType === "organization") {
          individualFields.style.display = "none";
          organizationFields.style.display = "block";
          fnameInput.removeAttribute("required");
          lnameInput.removeAttribute("required");
          orgNameInput.setAttribute("required", "");
        } else {
          // Default case when nothing is selected
          individualFields.style.display = "block";
          organizationFields.style.display = "none";
        }
      }

      function handleSponsor(e) {
        e.preventDefault();
        const seminarId = document.getElementById("seminarSelect").value;
        const sponsorType = document.getElementById("sponsorType").value;
        const amount = document.getElementById("amount").value;
        
        let name = "";
        let sp_fname = "";
        let sp_lname = null;
        
        if (sponsorType === "individual") {
          sp_fname = document.getElementById("fname").value;
          sp_lname = document.getElementById("lname").value;
          name = `${sp_fname} ${sp_lname}`;
        } else if (sponsorType === "organization") {
          sp_fname = document.getElementById("orgName").value;
          name = sp_fname;
        }

        if (!seminarId) {
          alert("Please select a seminar.");
          return;
        }

        if (!sponsorType) {
          alert("Please select a sponsor type.");
          return;
        }
        
        // Get the seminar name from our stored data
        let seminarName = 'the selected seminar';
        if (window.seminarData) {
          const seminar = window.seminarData.find(s => s.E_ID === seminarId);
          if (seminar) {
            seminarName = seminar.E_NAME;
          } else {
            // Try with string comparison in case E_ID is stored as string
            const seminarWithStringId = window.seminarData.find(s => String(s.E_ID) === String(seminarId));
            if (seminarWithStringId) {
              seminarName = seminarWithStringId.E_NAME;
            }
          }
        }

        // Send data to API
        const sponsorData = {
          sp_fname: sp_fname,
          sp_lname: sp_lname,
          sp_type: sponsorType === "individual" ? "I" : "O"
        };

        // Insert sponsor first
        fetch("../api/insert_sponsor.php", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(sponsorData),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.status === "success") {
              // Now create the sponsor-seminar relationship
              return fetch("../api/insert_sponsor_seminar.php", {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  sp_id: data.sponsor_id,
                  e_id: seminarId,
                  amount: amount
                }),
              });
            } else {
              throw new Error(data.message || "Failed to add sponsor");
            }
          })
          .then((response) => response.json())
          .then((data) => {
            if (data.status === "success") {
              const resultMsg = document.getElementById("resultMessage");
              resultMsg.textContent = `Thank you, ${name}, for sponsoring "${seminarName}" with $${amount}!`;
              resultMsg.classList.add("show");
              
              document.getElementById("sponsorForm").reset();
              toggleSponsorFields(); // Reset form fields visibility
              
              // Hide the message after 5 seconds
              setTimeout(() => {
                resultMsg.classList.remove("show");
              }, 5000);
            } else {
              alert(data.message || "Failed to link sponsor with seminar");
            }
          })
          .catch((error) => {
            console.error("Error:", error);
            alert("There was an error processing your request: " + error.message);
          });
      }
    </script>
    <script src="../js/customer_events.js"></script>
  </body>
</html>  